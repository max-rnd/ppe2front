<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Créer une exposition</title>
    <link rel="stylesheet" href="../style/bootstrap.css">
    <script src="../js/jquery.js"></script>
    <script src="../js/bootstrap.bundle.js"></script>
</head>
<body>
<form id="FormLogBDD" name="form" method="post" enctype="multipart/form-data">
    <h1>Créer une exposition</h1>
    <div class="form-group">
        <label for="titre">Titre de l'exposition</label>
        <input id="titre" type="text" name="Nom"/>
    </div>
    <div class="form-group">
        <label for="noteComm">Note du commissaire</label>
        <input id="noteComm" type="text" name="noteComm"/>
    </div>
    <div class="form-group">
        <label for="dd">Date Début</label>
        <input id="dd" type="date" name="DateDebut"/>
    </div>
    <div class="form-group">
        <label for="df">Date Fin</label>
        <input id="df" type="date" name="DateFin"/>
    </div>
    <div>
        <label for="artiste">Artiste</label>
        <select id="artiste"></select>
    </div>

    <button type="button" class="btn btn-primary" id="btncreer">Créer l'exposition</button>
</form>

<script>
    $(function () {           // attend que le document soit complétement chargé dans le dom
        artSel = document.getElementById('artiste');
        $.ajax({
            type: "GET",
            url: "http://localhost:8080/getAllArtiste.php",
            dataType: "json",
            success: function (val) {
                for (i = 0; i < val.length; i++) {
                    artSel.options[artSel.options.length] = new Option(val[i]['nom'] + " " + val[i]['prenom'], val[i]['id']);
                }
            }
        });
        $("#btncreer").click(function () {

            // Créer le formdata en passant directement les données du formulaires
            //let fd = new FormData(document.querySelector("#FormLogBDD"));

            // ou en passant les données une par une (pour en ajouter ou en enlever par exemple)
            var fd = new FormData();
            fd.append("titre",$("#titre").val());
            fd.append("noteComm",$("#noteComm").val());
            fd.append("DateDebut",$("#dd").val());
            fd.append("DateFin",$("#df").val());
            alert("fd ok");
            //fd.append("nomAffiche", $("#af")[0].files[0]);   //on ajoute le fichier dans le formData

            $.post("http://localhost:8080/expo", fd);
            alert("cc")




            /*$.ajax({
                type: "POST",
                url: "http://localhost:8080/expo",
                data: fd, //$("#FormLogBDD").serialize(),
                //contentType: false,     //nécessaire car passage de fichier
                //processData: false,     //nécessaire car passage de fichier
                dataType: "json",       //nécessaire car le service web retourne l'objet inséré en bdd en json
                success: function (val) {alert("cc");
                    alert($("#artiste").val(""));
                    if (val.id != 0) {             // si id=0 c'est que l'insertion ne s'est pas faite
                        $("#titre").val("");
                        $("#noteComm").val("");
                        $("#dd").val("");
                        $("#df").val("");
                        $("#artiste").val("");
                        alert("ok c bon");
                    } else alert("l'insertion ne s'est pas faite :-(");
                },
                error: function (jqXHR, status, t) {
                    alert("Malédiction c'est pas bon");     // problème réseau
                }
            });*/
        });
    });


</script>
</body>
</html>
